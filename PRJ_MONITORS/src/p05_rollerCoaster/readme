This implementation is not starvation-free